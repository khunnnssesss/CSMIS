
<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: html_head}"/>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/dashboard/css/app.css}">
    <link rel="stylesheet" th:href="@{/dashboard/vendor/feather-icons-web/feather.css}">
    <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css}" 
     integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
     crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" th:href="@{/dashboard/css/style.css}">
    <link rel="stylesheet" th:href="@{/dashboard/css/myStyle.css}">
    <style>
    .dataTables_length select{
    width:60px !important;}
    .dataTables_filter label{
    display:flex !important;}
     .swal2-container.swal2-center>.swal2-popup{
width:25em !important;
}
.swal2-title{
padding-top:0px !important;}
.swal2-styled.swal2-confirm{
width:80px !important;
}
    .card-height{
    height:550px;}
     .hide {
            display: none;
        }
        .show {
            display: block;
        }
        .modal-dialog{
        margin-top:10% !important;
        }
        .modal-content{
        width:80%;}
    
    </style>
</head>
<body>
<div th:replace="~{fragments :: userProfileFragment}"></div>
    <section class="container-fluid">
        <div class="row">
            <!-- sidebar start -->

                                    <!-- Modal -->
<div class="modal mt-5 fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-primary" id="exampleModalLongTitle">Avoid Meat Update</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form  method="post" id="avoidMeatForm">
      <div class="modal-body">
       
       <div>
        <input type="hidden" id="meatID"   class="form-control" />
       <input type="text" id="meatInput"    class="form-control" required/>
       </div>
      
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-success">Update</button>
      </div>
       </form>
    </div>
  </div>
</div>
<!-- Model -->

            
           <div th:replace="~{fragments :: html_sidebar}" ></div>
          
            <!-- sidebar end -->
            <div class="col-12  col-lg-9  col-xl-10 vh-100 content ">
                <!-- header start -->
               <div th:replace="~{fragments :: html_header}"></div>
                <!-- header end -->
                <!-- content start -->
                <div class="row">
                   
                   
 
  
                </div>
                <div class="row ">
                   
                               
                                </div>
                                <div class="row ">
                                    <div class="col-12">
                                        <div class="card mb-4 card-height">
                                            <div class="card-body">
                                              <div class="d-flex justify-content-between align-items-center">
                                               <h4 class="mb-0">
                                                   <i class="feather-codepen text-primary"></i>
                                                   Avoid Meat Data 
                                               </h4> 
                                               <button class="btn btn-outline-primary btn-sm full-page-btn"><i class="feather-maximize-2 h4"></i></button>  
                                              </div> 
                                              <hr> 
                                              
                                              
                                              <div class="row ">
                                <div class="col-12 col-md-5 col-lg-5">
                                  
                                  
                                  <!-- modal -->
                       <div class="card p-3 mt-5" style="background-color:#f0f0f0">           
                           
              <form th:action="@{/admin/doAvoidMeat}" th:object="${avoidMeat}" method="post" id="myForm">                                  
                                  
                                       
                                          <div class="mb-3">
                                            <label for="example1" class="form-label mb-0"><i class="fa-solid fa-bowl-food me-2 h5 text-primary"></i>Avoid Meat<span class="text-danger h5">*</span></label>
                                            <input type="text" class="form-control" name="avoid" th:value="${aa}" id="example1" required>
                                          </div>
                                          
                                   
                                     <div class="float-right" ><input class="btn btn-primary " type="submit" value="Add Avoid Meat"></input></div>
                                    </form>
                                    </div>
                                     </div>
                               
                                    <div class="col-12 col-md-7 col-lg-7 pb-5">
                                     <table id="example" class="table table-striped" style="width:100%;">
                                                          
                                                <thead class="bg-primary text-white
                                                " style="background-color:#278ea5;">
                                              
                                                    <tr>
                                                        <th class="text-center">Sr. No</th>
                                                        <th class="text-center">Avoid Meat</th>
                                                        
                                                        <th class="text-center">Action</th>
                                                        
                                                    </tr>
                                                </thead>
                                                <tbody>
		                                             <tr th:each="avoidMeat,index:${AvoidMeatList}" th:with="rowIndex=${index.index+1}">
		                                             <td class="text-center" th:text="${rowIndex}"></td>
		                                             <td class="text-center" th:text="${avoidMeat.meat}"></td>
		                                             <td class="text-center">
		                                            <a href="#" th:data-avoidmeatid="${avoidMeat.id}" onclick="updateAvoidMeat(this.getAttribute('data-avoidmeatid'));"> <i class="fa-solid fa-pen-to-square h5 text-warning me-2"></i></a>
		                                             <a th:href="@{/admin/deleteAvoidMeat/{id}(id=${avoidMeat.id})}" class="showModalButton"><i class="fa-solid fa-trash-can h5 text-danger"></i></a>
                                                   
	
		                                             </td>
		                                             </tr>
		                                             
		                          
		                                            
                                                </tbody>
                                                
                                            </table>
                                    </div>
                                   
                            </div>  
                                              
                                             
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                       
                    </div>
                  
            </div>
        </div>
    </section>

    
<div th:replace="~{fragments :: html_script}"/></div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<script th:inline="javascript">




  //
   $("#avoidMeatForm").validate({
     submitHandler: function(form,e){
       e.preventDefault();
      // var formData = new FormData(form); // Collect form data
        
       var meatValue = $('#meatInput').val();
          var meatID = $('#meatID').val();
          // AJAX request to send the form data
          $.ajax({
              url: '/admin/setupupdateAvoidMeat', // Update with your controller URL
              type: 'POST',
              data: {
                  meat: meatValue,id:meatID
              },
              success: function(response) {
                
                  console.log('AJAX request succeeded.');
                  Swal.fire({
                      text: response,
                      icon: 'success',
                      confirmButtonColor: '#3085d6',
                      confirmButtonText: 'OK'
                  }).then((result) => {
                      if (result.isConfirmed) {
                          window.location.reload(); // Reload the page
                      }
                  });

                  // Handle the success response here
                  // You can update the UI or perform other actions
              },
              error: function(xhr, status, error) {
                  console.log('AJAX request failed:', error);

                  // Handle the error response here
                  // You can display an error message or perform other actions
              }
          });

          // Close the modal box after form submission
          $('#exampleModalLong').modal('hide');
          
     },
       
        
        rules:{
           
            
           avoidMeat:{
              minlength:2,
              maxlength:100
          },
          
         },
              
        
        messages: {
         
          
          avoidMeat:{
         required: "Please enter avoid meat ",
         minlength: "Holidays name at least 2 characters",
         maxlength:"Holidays name at most 100 characters"
        },
        }
    });
  
  
  //
  $('table').ready(function() {
  var table = $('#example').DataTable({
      pageLength: 5,
      lengthMenu: [5, 10, 20, 50]
    });
    
} );

$("#myForm").validate({
     rules:{
     
      
       avoid:{
          minlength:2,
          maxlength:100
      },
      
     },
          
    
    messages: {
     
      
      avoid:{
     required: "Please enter avoid meat ",
     minlength: "Holidays name at least 2 characters",
     maxlength:"Holidays name at most 100 characters"
    },

    submitHandler:function(form){
    form.submit();
    }

  }
  }); 
$(document).ready(function() {
  
  
  
   var error = /*[[${message}]]*/ null;
     var success = /*[[${success}]]*/ null;
    if (error) {
        console.log("success");
        Swal.fire({
            text: error,
            icon: 'warning',
            confirmButtonColor: '#d33',
            confirmButtonText: 'OK'
        })
           }
    if (success) {
        console.log("success");
        Swal.fire({
            text: success,
            icon: 'success',
            confirmButtonColor: '#3085d6',
            confirmButtonText: 'OK'
        })
           }
  });
$('form').on('submit', function() {
    var meatInput = $('input[name="avoid"]');
    var meatValue = meatInput.val();
    var regex = /[1234567890!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/;

    if (regex.test(meatValue)) {
      Swal.fire({
        text: 'Invalid input! Special characters are not allowed.',
        icon: 'error',
        confirmButtonColor: '#ff1f5a',
        confirmButtonText: 'OK'
      });
      return false; // Prevent form submission
    }


return true; // Allow form submission
  });
function updateAvoidMeat(id) {
  
  
   
    $.ajax({
        url: '/admin/updateAvoidMeat/' + id,
        type: 'GET',
        success: function(response) {
            // Handle the success response here, if needed
            console.log(response);
            if(response!=null){
                $('#meatInput').val(response);
                $('#meatID').val(id);
               $('#exampleModalLong').modal('show');
            }
           
        },
        error: function(xhr, status, error) {
            // Handle the error response here, if needed
            console.log('AJAX request failed:', error);
        }
    });
}









 

        
</script>

</body>
</html>